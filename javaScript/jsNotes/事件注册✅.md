# 事件注册

edited time: Jan 23, 2021 5:37 PM

## 1 注册事件

---

给元素添加事件，称为注册事件或者绑定事件。注册事件的两种方式：1. 传统方式 2. 方法监听方式。

- 传统注册方式
    1. 利用on开头的事件，例如 `onclick`
    2. btn.onclick = function() {}
    3. 特点：注册事件的唯一性
    4. 同一个元素同一个事件只能设置一个处理函数，最后注册的处理函数会覆盖前面的处理函数。

- 方法监听注册方式
    1. w3c标准 推荐方式
    2. `addEventListener()` 是一个方法。
    3. ⚠️ IE9之前的IE不支持此方法，可使用 `attachEvent()`  代替。 
    4. 同一个元素，同一个事件，可以注册多个监听器。
    5. 按注册顺序依次执行。

`eventTarget.addEventListner(type, listener[, useCapture])` 

eventTarget.addEventListener() 方法将指定的监听器注册到目标对象上，当该对象触发指定事件时，就会执行事件处理函数。

三个参数：

- `type` 事件类型字符串，例如click, mouseover;
- `listener` 事件处理函数，事件发生时会调用该函数；
- `useCapture` 可选参数，boolean，默认是false。

```html
<script>
	var btns = document.querySelector('button')
	btns[0].addEventListener('click', function){
		alert('22');//监听器
}
</script>
```

同一元素，同一个事件可以添加多个侦听器(事件处理函数)。

兼容性封装函数：

![%E4%BA%8B%E4%BB%B6%E6%B3%A8%E5%86%8C%20de41d7f8963140b7ae8564d99834c174/Screen_Shot_2021-01-23_at_1.17.22_PM.png](%E4%BA%8B%E4%BB%B6%E6%B3%A8%E5%86%8C%20de41d7f8963140b7ae8564d99834c174/Screen_Shot_2021-01-23_at_1.17.22_PM.png)

 

## 2 删除事件（解绑事件）

---

1. 传统注册方式

    `eventTarget.onclick = null;`  

2. 监听事件
    - `eventTarget.removeEventListener()` 不能使用匿名函数。
    - `detachEvent()`

     

## 3 DOM事件流

---

事件流描述的是从页面中接收事件的顺序，事件发生时会在元素节点之间按特定的顺序传播，这个传播过程即DOM事件流。

DOM事件流分为3个阶段：

1. 捕获阶段
2. 当前目标阶段
3. 冒泡阶段（从里向外）

![%E4%BA%8B%E4%BB%B6%E6%B3%A8%E5%86%8C%20de41d7f8963140b7ae8564d99834c174/Screen_Shot_2021-01-23_at_2.13.21_PM.png](%E4%BA%8B%E4%BB%B6%E6%B3%A8%E5%86%8C%20de41d7f8963140b7ae8564d99834c174/Screen_Shot_2021-01-23_at_2.13.21_PM.png)

![%E4%BA%8B%E4%BB%B6%E6%B3%A8%E5%86%8C%20de41d7f8963140b7ae8564d99834c174/Screen_Shot_2021-01-23_at_2.24.23_PM.png](%E4%BA%8B%E4%BB%B6%E6%B3%A8%E5%86%8C%20de41d7f8963140b7ae8564d99834c174/Screen_Shot_2021-01-23_at_2.24.23_PM.png)

注意：⚠️

1. JS代码中只能执行捕获或者冒泡其中的一个阶段。
2. `onclick`和 `attachEvent`只能得到冒泡阶段。
3. `addEventListener(type, listener[, useCapture])`第三个参数如果是true，表示在事件捕获阶段调用事件处理程序；如果是default或false，表示在事件冒泡阶段调用事件处理程序。

    实际开发中更关心事件冒泡。有些events是没有冒泡的！！

## 3 事件对象

---

```jsx
div.onclick = function(event){
	//event 则是事件对象，当作形参来看
	console.log(event);
}

div.addEventListener('click', function(event)){
	console.log(event);
}

//常用写法
	console.log(e);
	console.log(evt);
	...
```

官方解释： `event` 对象代表事件的状态，比如键盘按键的状态，鼠标的位置，鼠标按钮的状态。

事件对象是我们事件的一系列相关数据的集合 ；例如键盘事件里包含了键盘事件的信息，比如判断用户按下了哪个键。

当我们注册事件时， `event` 对象会被自动创建，并依次传递给事件监听器。

- 事件对象常用的属性和方法

    ![%E4%BA%8B%E4%BB%B6%E6%B3%A8%E5%86%8C%20de41d7f8963140b7ae8564d99834c174/Screen_Shot_2021-01-23_at_4.36.06_PM.png](%E4%BA%8B%E4%BB%B6%E6%B3%A8%E5%86%8C%20de41d7f8963140b7ae8564d99834c174/Screen_Shot_2021-01-23_at_4.36.06_PM.png)

- 阻止事件冒泡

    事件冒泡：开始时由最具体的元素接收，然后逐级向上传播到DOM最顶层节点。

    使用 `stopPropagation()` 阻止冒泡。

- 事件委托

    原理：不是每个子节点单独设置事件监听器，而是事件监听器设置在其父节点上，然后利用冒泡原理影响设置每个子节点。

    优点：只操作了一次DOM，提高性能。

- 鼠标事件对象

    ![%E4%BA%8B%E4%BB%B6%E6%B3%A8%E5%86%8C%20de41d7f8963140b7ae8564d99834c174/Screen_Shot_2021-01-23_at_5.22.09_PM.png](%E4%BA%8B%E4%BB%B6%E6%B3%A8%E5%86%8C%20de41d7f8963140b7ae8564d99834c174/Screen_Shot_2021-01-23_at_5.22.09_PM.png)

`MouseEvent`

![%E4%BA%8B%E4%BB%B6%E6%B3%A8%E5%86%8C%20de41d7f8963140b7ae8564d99834c174/Screen_Shot_2021-01-23_at_5.35.06_PM.png](%E4%BA%8B%E4%BB%B6%E6%B3%A8%E5%86%8C%20de41d7f8963140b7ae8564d99834c174/Screen_Shot_2021-01-23_at_5.35.06_PM.png)

- 键盘事件

    ![%E4%BA%8B%E4%BB%B6%E6%B3%A8%E5%86%8C%20de41d7f8963140b7ae8564d99834c174/Screen_Shot_2021-01-23_at_5.37.16_PM.png](%E4%BA%8B%E4%BB%B6%E6%B3%A8%E5%86%8C%20de41d7f8963140b7ae8564d99834c174/Screen_Shot_2021-01-23_at_5.37.16_PM.png)